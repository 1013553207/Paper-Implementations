# PyTorch Implementation of BEGAN

PyTorch Implementation of [BEGAN: Boundary Equilibrium Generative Adversarial Networks](https://arxiv.org/abs/1703.10717).

## Prerequisites
- PyTorch
- torchvision

## Testing using pre-trained model
   - To generate 64x64 faces

   ```
   python generate.py --cuda --netG dcgan/netG_200000.pth --imageSize 64 --ngf 64 --nz 64
   ```

## Training

- Download [CelebA](http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html), choose the `Aligh&Croped Images` zip. Unzip it and put it under `data/` directory.
- Go into folder `Data` and run `python face_detect.py`, this script will detect and crop faces and store them under `Data/64_crop/` and `Data/128_crop` folder, this detecting and cropping script is from [BEGAN-tensorflow](https://github.com/Heumi/BEGAN-tensorflow/tree/master/Data) 
- Training

  **Train on 64x64 images**
  ```
  python began.py --cuda --dataPath Data/64_crop --gamma 0.4 --niter 200000
  ```

- Î³ = 0.4, 64 x 64, 200k iterations

![generation](dcgan/64x64.png "BEGAN")

### During my implementation, these tips are noticed to be critical for this algorithm to work well:
1. `Tanh()` layer at the end of generator and discriminator. Without this layer, 64x64 images generated by generator could be "foggy".
2. Detect and crop faces first. Without this preprocess step, severe mode collapse is observed when training on 128x128 images.

## Reference
1. [https://github.com/carpedm20/BEGAN-tensorflow](https://github.com/carpedm20/BEGAN-tensorflow)
2. Berthelot, David, Tom Schumm, and Luke Metz. "BEGAN: Boundary Equilibrium Generative Adversarial Networks." arXiv preprint arXiv:1703.10717 (2017).
3. [https://github.com/Heumi/BEGAN-tensorflow/tree/master/Data](https://github.com/Heumi/BEGAN-tensorflow/tree/master/Data)
